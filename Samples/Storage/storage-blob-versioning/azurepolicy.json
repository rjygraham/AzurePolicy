{
	"properties": {
		"displayName": "Audit/Deny Storage Account Blob Versioning",
		"description": "This policy audits/denies creation of Storage Accounts that do not have blob versioning enabled.",
		"mode": "Indexed",
		"metadata": {
			"version": "1.0.0",
			"category": "Storage"
		},
		"parameters": {
			"effect": {
				"type": "String",
				"metadata": {
					"displayName": "Effect",
					"description": "Audit, deny, or disable the execution of the policy"
				},
				"allowedValues": [
					"Audit",
					"Deny",
					"Disabled"
				],
				"defaultValue": "Audit"
			}
		},
		"policyRule": {
			"if": {
				"allOf": [
					{
						"field": "type",
						"equals": "Microsoft.Storage/storageAccounts/blobServices"
					},
					{
						"field": "Microsoft.Storage/storageAccounts/blobServices/default.isVersioningEnabled",
						"notEquals": true
					}
				]
			},
			"then": {
				"effect": "[parameters('effect')]"
			}
		}
	}
}